package test.others;

import com.alibaba.fastjson.JSONArray;
import com.alibaba.fastjson.JSONObject;
import com.google.gson.Gson;
import com.google.gson.reflect.TypeToken;
import org.apache.commons.httpclient.HttpClient;
import org.apache.commons.httpclient.HttpMethod;
import org.apache.commons.httpclient.methods.PostMethod;
import org.apache.commons.httpclient.methods.RequestEntity;
import org.apache.commons.httpclient.methods.StringRequestEntity;
import org.apache.commons.lang.StringUtils;
import org.junit.Test;

import java.io.*;
import java.math.BigDecimal;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

public class AdTest {

    @Test
    public void testShopDealPair() throws Exception {
        HttpClient httpClient = new HttpClient();
        httpClient.getParams().setContentCharset("UTF-8");

        PostMethod method = new PostMethod("http://localhost:8081/mt-bizer/baymax/mtbizer/mtdealad.bin");
        method.addRequestHeader("Content-Type","application/x-www-form-urlencoded");
        method.addRequestHeader("Accept","application/json");
        method.addRequestHeader("pragma-unionid","29cec094e650417fb746e6e11a16da910000000000000076712");
        method.addRequestHeader("utm-source","Alpha");
        method.addRequestHeader("connection","upgrade");
        method.addRequestHeader("host","mapi.meituan.com");
        method.addRequestHeader("pragma-apptype","com.meituan.imeituan-beta");
        method.addRequestHeader("user-agent","mapi 1.1 (mtscope 8.8.0 appstore; iPhone 10.2 iPhone9,2; a0d0)");
        method.addRequestHeader("utm-campaign","AgroupBgroupGhomepage_category1_1__a1__c__e2078H0");
        method.addRequestHeader("pragma-os","MApi 1.1 (mtscope 8.8.0 appstore; iPhone 10.2 iPhone9,2; a0d0)");

        method.addParameter("idfv","56C94EE0-A495-4140-86ED-B81121E577ED");
        method.addParameter("pageContext","{\"advancedFilter\":{},\"stationID\":0,\"areaID\":-3,\"sortType\":0,\"lineID\":0,\"categoryID\":1}");
        method.addParameter("packagever","98");
        method.addParameter("viewshopid","455409");
        method.addParameter("userid","");
        method.addParameter("lng","121.412012618831");
        method.addParameter("categoryids","20004,1");
        method.addParameter("cityid","10");
        method.addParameter("wifi","{\"wifi_env\":[],\"wifi_use\":{\"mac\":\"\",\"ssid\":\"\"}}");
        method.addParameter("slotid","50003");
        method.addParameter("viewdealid","33460012");
        method.addParameter("viewtypes","0,1,2");
        method.addParameter("channel","food");
        method.addParameter("idfa","F9791DAF-3085-4B0B-A72E-8D250DED46F9");
        method.addParameter("lat","31.207459150474");

        httpClient.executeMethod(method);

        System.out.println(method.getStatusLine());
        System.out.println(method.getStatusCode());
        ObjectInputStream objectInputStream = new ObjectInputStream(method.getResponseBodyAsStream());
        String line = String.valueOf(objectInputStream.readObject());
        System.out.println("response:"+line);
    }

    @Test
    public void testGetResults() {
        CpcDetail cpcDetail = new CpcDetail();
        cpcDetail.setShopid(6265516);
        cpcDetail.setShopname("黄山宏村添灯食堂");
        cpcDetail.setCategoryName("徽菜|徽州菜");
        cpcDetail.setDistrict("宏村");
        cpcDetail.setRegion("黟县");
        cpcDetail.setHuidesc("每满100减12（买单立享）");
        cpcDetail.setPictureurl("https://img.meituan.net/msmerchant/0b1de3008c30d78d0a476941c95834bb146500.jpg");
        cpcDetail.setPower(4.4);
        cpcDetail.setRankingtags("宏村徽菜第3名");
        cpcDetail.setRecommendlang("测试推荐语");
        List<DealDetail> deals = new ArrayList<>();
        cpcDetail.setDeals(deals);

        DealDetail deal = new DealDetail();
        deal.setDealid(39343718);
        deal.setDealtitle("50元代金券1份，可叠加");
        deal.setDealdesc("仅售46元！价值50元的代金券1份，除酒水、饮料、特价菜外全场通用，可叠加使用，可免费使用包间，提供免费WiFi。");
        deal.setDealimgurl("http://p1.meituan.net/w.h/deal/09d2bc20445cc55228b9e7eecfa888fb50670.jpg@0_6_640_387a%7C388h_640w_2e_100q");
        deal.setDealmarketprice(50);
        deal.setDealprice(46);
        deal.setDealsales(3);
        deal.setDiscoff( new BigDecimal(deal.getDealprice()).divide(new BigDecimal(deal.getDealmarketprice()),2,BigDecimal.ROUND_HALF_UP).doubleValue());
        deal.setDealTag("maxdiscountdeal");
        deals.add(deal);

        DealDetail deal2 = new DealDetail();
        deal2.setDealid(35207000);
        deal2.setDealtitle("双人餐，包间免费");
        deal2.setDealdesc("仅售98元！价值115元的双人餐，可免费使用包间。");
        deal2.setDealimgurl("http://p1.meituan.net/w.h/deal/09d2bc20445cc55228b9e7eecfa888fb50670.jpg@0_6_640_387a%7C388h_640w_2e_100q");
        deal2.setDealmarketprice(115);
        deal2.setDealprice(98);
        deal2.setDealsales(21);
        deal2.setDiscoff(new BigDecimal(deal2.getDealprice()).divide(new BigDecimal(deal2.getDealmarketprice()),2,BigDecimal.ROUND_HALF_UP).doubleValue());
        deal2.setDealTag("maxsalesdealgroup");
        deals.add(deal2);

        System.out.println(new Gson().toJson(cpcDetail));
    }

    private static final String launchids = "22842426,22888494,22937423,22979080,22987595,23003207,23014659,23015152,23017742,23028750,23041047,23053777,23057366,23072920,23073723,23074917,23094774,23096406,23099608,23101727,23101777,23102184,23106074,23106465,23107029,23107569,23109639,23110619,23120973,23121517,23122093,23123829,23123021,23123910,23128870,23130826,23135040,23137853,23143410,23143269,23148200,23147872,23148432,23149370,23150370,23150404,23152406,23152498,23154481,23156232,23156601,23158478,23158887,23159232,23160838,23166076,23167362,23167554,23170163,23170725,23171842,23174702,23181564,23182474,23185777,23189033,23196572,23197850,23198995,23199385,23199104,23200182,23201625,23202202,23202522,23201010,23204462,23205558,23205963,23206005,23204784,23205763,23206889,23206951,23207990,23209170,23208679,23209512,23210326,23211089,23211463,23211532,23212159,23213359,23215127,23215248,23214233,23218936,23220134,23220135,23220677,23221614,23222494,23223665,23223930,23223984,23225740,23225862,23226167,23226225,23226482,23227813,23227878,23228196,23228222,23228638,23229131,23229463,23229855,23229947,23230225,23230474,23231590,23232436,23232800,23234984,23235257,23236827,23236929,23237257,23237152,23237282,23238032,23238178,23240731,23243407,23238132,23238948,23242136,23238309,23242438,23243655,23243767,23243804,23244334,23244736,23244106,23244823,23244840,23245243,23244332,23245268,23245390,23245353,23245607,23246026,23246199,23246498,23246583,23246557,23246620,23246741,23246759,23247210,23247442,23247621,23247627,23247824,23247928,23247950,23247962,23247965,23247968,23247973,23247976,23247966,23247994,23248008,23248009,23248030,23247983,23247985,23248065,23248068,23248042,23248104,23248108,23248058,23248124,23248126,23248127,23248131,23248141,23248151,23248153,23248168,23248177,23248178,23248184,23248245,23248183,23248217,23248287,23248301,23248319,23248330,23248340,23248198,23248271,23248364,23248367,23248370,23248373,23248379,23248383,23248384,23248385,23248386,23248388,23248413,23248430,23248460,23248468,23248471,23248481,23248428,23248500,23248506,23248507,23248510,23248512,23248513,23248499,23248510,23248526,23248534,23248535,23248545,23248548,23248549,23248550,23248554,23248527,23248528,23248557,23248562,23248570,23248571,23248572,23248573,23248577,23248591,23248592,23248489,23248540,23248602,23248614,23248590,23248621,23248628,23248653,23248660,23248663,23248664,23248670,23248673,23247611,23247926,23247978,23248164,23248209,23248675,23248677,23248678,23248242,23248293,23248297,23248387,23248455,23248595,23248682,23248710,23248697,23248609,23248623,23248741,23248395,23248746,23248668,23248681,23248737,23248435,23248450,23248768,23248773,23248774,23248784,23248786,23248788,23248789,23248296,23248426,23248805,23248809,23248810,23248829,23248830,23248839,23248840,23248844,23248845,23248846,23248849,23248860,23248861,23248862,23248863,23248867,23248874,23248876,23248895,23248899,23248901,23248904,23248909,23248939,23248944,23248950,23248951,23248955,23248963,23248968,23248973,23248985,23248989,23248990,23249008,23249016,23249045,23249061,23249067,23249077,23249085,23249095,23249114,23249122,23249128,23249135,23249136,23249163,23249168,23249171,23249177,23249181,23249182,23249197,23249204,23249206,23249207,23249216,23249254,23249260,23249261,23249270,23249280,23249290,23249306,23249307,23249308,23249316,23249320,23249353,23249373,23249394,23249395,23249398,23249418,23249427,23249437,23249454,23249473,23249502,23249508,23249514,23249543,23249546,23249557,23249577,23249583,23249584,23249599,23249633,23249639,23249641,23249672,23249673,23249694,23249721,23249739,23249741,23249769,23249776,23249811,23249813,23249825,23249827,23249840,23249868,23249870,23249874,23249875,23249880,23094094,23248879,23248880,23248964,23249043,23249041,23249265,23249434,23249433,23249914,23249940,23249991,23250006,23250020,23250021,23250025,23250027,23250028,23250035,23250055,23250063,23248920,23250081,23249264,23249349,23249431,23248792,23248945,23250095,23250106,23250129,23250133,23250146,23250155,23250157,23250022,23250244,23250245,23250253,23250255,23250257,23250266,23250282,23250341,23250342,23250350,23250366,23250367,23250383,23250384,23250385,23250394,23250404,23250407,23250419,23250421,23250438,23250445,23250449,23250482,23248819,23248922,23249312,23250241,23250518,23250519,23250521,23250522,23250529,23250549,23250554,23250568,23250580,23250583,23250592,23250594,23250597,23250602,23250610,23250614,23250629,23250633,23250634,23250636,23250637,23250653,23250627,23250713,23250736,23250737,23250741,23250749,23250765,23250766,23250772,23250773,23250776,23250789,23250803,23250837,23250841,23250629,23250629,23250629,23250858,23250873,23250883,23250894,23250897,23250927,23250985,23251012,23251016,23251018,23251010,23251009,23251025,23251035,23251039,23251041,23248837,23248848,23248865,23248908,23248962,23249017,23249032,23251075,23249132,23249145,23249238,23249284,23249464,23249580,23249733,23249881,23250097,23250635,23250768,23250799,23250856,23250966,23251097,23251117,23251118,23251124,23251129,23251153,23251174,23251133,23251223,23251224,23251304,23251307,23251330,23251352,23251383,23251389,23251393,23251415,23251416,23250847,23251355,23251385,23251434,23251443,23251445,23251506,23251512,23251522,23251534,23251543,23251546,23251552,23251556,23251607,23251623,23251624,23251638,23251651,23251652,23251663,23251680,23251686,23251664,23251703,23251704,23251733,23251740,23251746,23251769,23251779,23251802,23251804,23251809,23251811,23251776,23251821,23251824,23251825,23251830,23251852,23251874,23251885,23251910,23251915,23251925,23251926,23251950,23251951,23251962,23251978,23251979,23252006,23252011,23252019,23252027,23251983,23252074,23252104,23252127,23251931,23251932,23252171,23252180,23252186,23252187,23252197,23252198,23252199,23252201,23252203,23252204,23252205,23252235,23252237,23252248,23252253,23252264,23252294,23252224,23252306,23252318,23252326,23252329,23252348,23251911,23251987,23252000,23252105,23252175,23252363,23252403,23252423,23252383,23252462,23252463,23252467,23252481,23252484,23252448,23252489,23252491,23251449,23252504,23252390,23252510,23250767,23251151,23251466,23251615,23251878,23252386,23252406,23252457,23252492,23252524,23252533,23252541,23252548,23252553,23252559,23252561,23252562,23252579,23252583,23252586,23252412,23252603,23252607,23252619,23252630,23252638,23252647,23252651,23252674,23252678,23252679,23252683,23252693,23252702,23252715,23252723,23252738,23252751,23252782,23252788,23252789,23252793,23252820,23252823,23252825,23252882,23252904,23252937,23252939,23252968,23252975,23252978,23253003,23253021,23253025,23253026,23253036,23253037,23253039,23253042,23253046,23253059,23253065,23253069,23253076,23253086,23253100,23253131,23253132,23253148,23253152,23253154,23253161,23253169,23253171,23253172,23253193,23253202,23253226,23253233,23253237,23253239,23253261,23253263,23253264,23253265,23253267,23253268,23253272,23253273,23253275,23253276,23253277,23253290,23253291,23253295,23253297,23253298,23253302,23253303,23253321,23253342,23253355,23253361,23253375,23253389,23253412,23253453,23253466,23253480,23253484,23253504,23253505,23253507,23253511,23253512,23253524,23253528,23200632,23200632,23200632,23200632,23200632,23200632,23200632,23200632,23253540,23253541,23253562,23253567,23253655,23253669,23253671,23253692,23253694,23253701,23253128,23253779,23253813,23253827,23253831,23253853,23253859,23253865,23253878,23253886,23252624,23252875,23252979,23253901,23253904,23253905,23253907,23253909,23252750,23253912,23253925,23253927,23252853,23253099,23253300,23253938,23253961,23253971,23253974,23253989,23254003,23254004,23254012,23254030,23254035,23254036,23254049,23254061,23254068,23254069,23254078,23254081,23254087,23254103,23253990,23254110,23254057,23254133,23254144,23254156,23254157,23254176,23254180,23254191,23254201,23254129,23254187,23254249,23254262,23254297,23254298,23254299,23254234,23254318,23254346,23254366,23254367,23254371,23254390,23254406,23252518,23253745,23254423,23254425,23254434,23254448,23254289,23254290,23254459,23254465,23254466,23254484,23254427,23254507,23254547,23254557,23254560,23254512,23254571,23254573,23254580,23254591,23254595,23254600,23254555,23252556,23252799,23252847,23252895,23252921,22892272,23254619,23253221,23253232,23253345,23253391,23254625,23253645,23253675,23253695,23253716,23253744,23253806,23253984,23254128,23254190,23254256,23254369,23254452,23254635,23254650,23254654,23254658,23254660,23228194,23254669,23254671,23254679,23254701,23254706,23254711,23254716,23254722,23254726,23254741,23254746,23254749,23254752,23254753,23254762,23254763,23254771,23254779,23254782,23254802,23254813,23254864,23254868,23254871,23254874,23254876,23254748,23254896,23254918,23254935,23254936,23254937,23254558,23254950,23254951,23254957,23254966,23254987,23254994,23254998,23255002,23255007,23254879,23255013,23255015,23255025,23255051,23255057,23255067,23255068,23255071,23255077,23255092,23255096,23255097,23255115,23255120,23255125,23255050,23255053,23255164,23255171,23255184,23255191,23255205,23255221,23255253,23255254,23255260,23255265,23255266,23255295,23255123,23255198,23255300,23255316,23255322,23255346,23255347,23255374,23255375,23255383,23255338,23255343,23255386,23255388,23255390,23255395,23255396,23255414,23255424,23255428,23255432,23255470,23255473,23255477,23255481,23255484,23255486,23255492,23255502,23255523,23232977,23232977,23255530,23255549,23255554,23255577,23255578,23255582,23255596,23255614,23255627,23255630,23255641,23255576,23255657,23255661,23255670,23255693,23255709,23255718,23255720,23255732,23255746,23255753,23255672,23255755,23255760,23255771,23255788,23255789,23255797,23255798,23255810,23255811,23255821,23255827,23255804,23255839,23255857,23255867,23255871,23255880,23255882,23255889,23255890,23255899,23255904,23254676,23254683,23254712,23254883,23254933,23254929,23255044,23255150,23255283,23255914,23255352,23255437,23255570,23255690,23255799,23255800,23255822,23255835,23255918,23252740,23255926,23255939,23255940,23255943,23255948,23255949,23255954,23255961,23255962,23255974,23255977,23255979,23255985,23255997,23256003,23255975,23256004,23256013,23256020,23256022,23256029,23255960,23256032,23256044,23255956,23256053,23256059,23256060,23256061,23256071,23256073,23256075,23256081,23255446,23255780,23255987,23256034,23256098,23256105,23256134,23256137,23256138,23254804,23254962,23254986,23256178,23256181,23256212,23256219,23256232,23256250,23256258,23256260,23256263,23256279,23256283,23256284,23256299,23256319,23256320,23256332,23256346,23256347,23256363,23256380,23256408,23256413,23256452,23256464,23256471,23256475,23256493,23256517,23256518,23256523,23256532,23256552,23256557,23256579,23256580,23256588,23256596,23256603,23256620,23256622,23256630,23256631,23256652,23256674,23256699,23256722,23256727,23256730,23256737,23256749,23256752,23256757,23256758,23256772,23256776,23256786,23256809,23256810,23256827,23256878,23256882,23256885,23256889,23256898,23256930,23240696,23240696,23240696,23256970,23257010,23257013,23257020,23257052,23257093,23257102,23254978,23256527,23256716,23094094,23257121,23257140,23257151,23257156,23257163,23257168,23257199,23257201,23257215,23257220,23257240,23257244,23256074,23256103,23256129,23256371,23256373,23256465,23257266,23257267,23257273,23256069,23256078,23256123,23256719,23256779,23256933,23257209,23257239,23257290,23257268,23257295,23257302,23257314,23257354,23257359,23257380,23257392,23257394,23257400,23257403,23257406,23257407,23257408,23257416,23257421,23257442,23257446,23257451,23257495,23257500,23257465,23257510,23257522,23257528,23257532,23257547,23257549,23257551,23257557,23257567,23257568,23257574,23257590,23257594,23257595,23257597,23257382,23257576,23257603,23257611,23256313,23256505,23256854,23256856,23257119,23257488,23257623,23257624,23257548,23257629,23257644,23256052,23256107,23256179,23256246,23256275,23256381,23256542,23256875,23257081,23257087,23257183,23257701,23257588,23257710,23257752,23257756,23257767,23257768,23257770,23257637,23257796,23257798,23257805,23257764,23257819,23257824,23257766,23257839,23257846,23257866,23257869,23257875,23257882,23257887,23257897,23257913,23257924,23257925,23257949,23257966,23257982,23258008,23258016,23258026,23258035,23258065,23258068,23258116,23258118,23258133,23258135,23257843,23258010,23258143,23258144,23258146,23258153,23258172,23258180,23258184,23257987,23258166,23258218,23258224,23258227,23258242,23258259,23258269,23258271,23258310,23258241,23258338,23258353,23258394,23258405,23258412,23258447,23258454,23258456,23258483,23258487,23258488,23258489,23258494,23258519,23258530,23258537,23258539,23258549,22810285,23258473,23258526,23258612,23258645,23258660,23258667,23258677,23258685,23258699,23258700,23258703,23258708,23258716,23258725,23258740,23258745,23258746,23258748,23258762,23258765,23258769,23258557,23258560,23258589,23258680,23258777,23258786,23258793,23258796,23258798,23258807,23258814,23258819,23258866,23258874,23258876,23258878,23258880,23258886,23258903,23258928,23258968,23258971,23258985,23258805,23258997,23259005,23259008,23259013,23259018,23259025,23259037,23259041,23259047,23259052,23259062,23259064,23259105,23259054,23259080,23259129,23259150,23259169,23259158,23259185,23259186,23259204,23259207,23258553,23258733,23258809,23259182,23259250,23259263,23259265,23259274,23259281,23259282,23259299,23259308,23259324,23259328,23259331,23259260,23259335,23259340,23259341,23259346,23259347,23257837,23257895,23257998,23258009,23258154,23258217,23258320,23258477,23258696,23259292,23259372,23259374,23259386,23259388,23259409,23259414,23259415,23259417,23259421,23259426,23259429,23259361,23259384,23259441,23259443,23259450,23259454,23259473,23259301,23259380,23259497,23259507,23259509,23259525,23259541,23259542,23259544,23259547,23259552,23259561,23259568,23259569,23259572,23259576,23259606,23259611,23259628,23259630,23259640,23259645,23259648,23259668,23259682,23259685,23259686,23259699,23259708,23259709,23259713,23259714,23259728,23259742,23259744,23259752,23259760,23259765,23259771,23259785,23259789,23259790,23259819,23259820,23259824,23259833,23259843,23259846,23259851,23259853,23259863,23259885,23259890,23259908,23259920,23259928,23259933,23259938,23259946,23259947,23259954,23259957,23259960,23259985,23259997,23259998,23260001,23260003,23260022,23260026,23260035,23260059,23260068,23260069,23260092,23260101,23260102,23260127,23222843,23222843,23222843,23222843,23222843,23222843,23260150,23260163,23260174,23246759,23246759,23246759,23260185,23260226,23260227,23260231,23260250,23260255,23260257,23260268,23260276,23260294,23260295,23260320,23260322,23260370,23260382,23260390,23260393,23260398,23260403,23260431,23260435,23260442,23260448,23260449,23260456,23260469,23260477,23260491,23260505,23260508,23260509,23260523,23260525,23260532,23260536,23260540,23260547,23260550,23260555,23260560,23260570,23260571,23260580,23260596,23260602,23260644,23260653,23260668,23260705,23260728,23260747,23260774,23260786,23260794,23260815,23260826,23260828,23260831,23253036,23253036,23253036,23253036,23260854,23260892,23260942,23260949,23260956,23260963,23260970,23260971,23260990,23260992,23260996,23260999,23261031,23261035,23261063,23261081,23261083,23261108,23261126,23261135,23261149,23261160,23261161,23261165,23261170,23261187,23261217,23261237,23261241,23261245,23261248,23261268,23261293,23261308,23261312,23261321,23261329,23261339,23261344,23261357,23261431,23261433,23261436,23261450,23261455,23261456,23261462,23261463,23261476,23261480,23261482,23261496,23261508,23261543,23261546,23261573,23261574,23261579,23261619,23261622,23261644,23261663,23261665,23261680,23261695,23261712,23261759,23261787,23261808,23261813,23261851,23261872,23261916,23261940,23261954,23261956,23261962,23262000,23262011,23262026,23262077,23262087,23262105,23262156,23262173,23262178,23262185,23262193,23262239,23262259,23262267,23262286,23262311,23262314,23262324,23262326,23262335,23262336,23262362,23262365,23262369,23262380,23262382,23262384,23262386,23262430,23262436,23262443,23262444,23262482,23262541,23262562,23262571,23262580,23262593,23221030,23221030,23221030,23262610,23262621,23262624,23262637,23262651,23262666,23262672,23262675,23262696,23262771,23262780,23262786,23262791,23262799,23262828,23262867,23262870,23262892,23262902,23262905,23262907,23262916,23262921,23262941,23262943,23262944,23262958,23262985,23262993,23263036,23263041,23263080,23263096,23263118,23263122,23263127,23263137,23263159,23263173,23263194,23263203,23263214,23263223,23263269,23263283,23263296,23263312,23263323,23263329,23263342,23260871,23263357,23261345,23254150,23254970,23255105,23257247,23259404,23263380,23263382,23263386,23263421,23263425,23262534,23262577,23263412,23263449,23263465,23263486,23259419,23259486,23259617,23259647,23259693,23259936,23259964,23260013,23260504,23260737,23263493,23263498,23263501,23263506,23261523,23261973,23260212,23262169,23259504,23259608,23259643,23259660,23259677,23259721,23259865,23259961,23259973,23259999,23260110,23260169,23259539,23259603,23259667,23259687,23260478,23260482,23261792,23259837,23232977,23260303,23260542,23260694,23260725,23260845,23260939,23261093,23261113,23261128,23261358,23260496,23261477,23261571,23261605,23261685,23261736,23261966,23262519,23262598,23262616,23263535,23262615,23262670,23262820,23262923,23262994,23263018,23263039,23263082,23263169,23263171,23263104,23263549,23260960,23263566,23263567,23262051,23262268,23263270,23263271,23261066,23261214,23263577,23262343,23262754,23263086,23263359,23263359,23263373,23263619,23263621,23263622,23263623,23263626,23263671,23263675,23263691,23263701,23263638,23263672,23263742,23263743,23263745,23263795,23263807,23263809,23263816,23263823,23263825,23263842,23263843,23263852,23263865,23263775,23263871,23263879,23263893,23263921,23263934,23263946,23263950,23263954,23263975,23263992,23263999,23264001,23264006,23264019,23264040,23263753,23264048,23264052,23264066,23264075,23264077,23263918,23263941,23263986,23264081,23264083,23264084,23263680,23264096,23264113,23264070,23264107,23264141,23264143,23264150,23264153,23264155,23264167,23264199,23264205,23264207,23264212,23264214,23264225,23264226,23264227,23264239,23264249,23264311,23264317,23264325,23264331,23264334,23264342,23264346,23264352,23264358,23264369,23264395,23264428,23264062,23264469,23264487,23264495,23264309,23264411,23264516,23264536,23264540,23264554,23264112,23264337,23264350,23264356,23264368,23264379,23264134,23264332,23264480,23264580,23264597,23264551,23264603,23264608,23264613,23264622,23264639,23264640,23264647,23264659,23264691,23264707,23264721,23264734,23264739,23264744,23264804,23264819,23264837,23264841,23264787,23264873,23264890,23264906,23264910,23264917,23264951,23264965,23265012,23264934,23264956,23265045,23265051,23265057,23265058,23265060,23265065,23265090,23265094,23265099,23265103,23265111,23265120,23265122,23265095,23265144,23264561,23264912,23264945,23264982,23265158,23265161,23265164,23265211,23265214,23265220,23265236,23265259,23265269,23265271,23265281,23265283,23265284,23265286,23265293,23265311,23265337,23265340,23265341,23264713,23264749,23264798,23264811,23264826,23264865,23264933,23264990,23265091,23265190,23265280,23265322,23265345,23265355,23265381,23265389,23265342,23265393,23265403,23265410,23265412,23265428,23265433,23265434,23265443,23265448,23265465,23265467,23265469,23265488,23265491,23265493,23265492,23265507,23265524,23265548,23265344,23265564,23265574,23265575,23265592,23222785,23222785,23222785,23265619,23265623,23265627,23265653,23265672,23259607,23265676,23262445,23265690,23265693,23265679,23265692,23265707,23265709,23264296,23264513,23264724,23265710,23265522,23265584,23265735,23265760,23265764,23265768,23265772,23265773,23265790,23265793,23265203,23265221,23265531,23265696,23265820,23265864,23265866,23265876,23265878,23265898,23265901,23265913,23265917,23265918,23265936,23265958,23265959,23265975,23266006,23266018,23266023,23266030,23266036,23266046,23266083,23266097,23266119,23266125,23266140,23266144,23266148,23266153,23266166,23266187,23266188,23266190,23266217,23266249,23266256,23266262,23266297,23266311,23266314,23266317,23266340,23266343,23266348,23266349,23266353,23266365,23266382,23266388,23266401,23266412,23266436,23266438,23266456,23266467,23266490,23266499,23266512,23266528,23266545,23266558,23266560,23266589,23266612,23266615,23266621,23266673,23266687,23266705,23266710,23266711,23266713,23265830,23265855,23266051,23266108,23266357,23266372,23266440,23266734,23266750,23266752,23266753,23266758,23266768,23266798,23266829,23265849,23266836,23266506,23266790,23266805,23265801,23266407,23266601,23266845,23266854,23266874,23266876,23266889,23266890,23266892,23266904,23266909,23266921,23266928,23266933,23266936,23266938,23266946,23232977,23265884,23265894,23266949,23266032,23266245,23266632,23266963,23266815,23266970,23266979,23266980,23266982,23267000,23267003,23267009,23267038,23267039,23267051,23267067,23266847,23267072,23267084,23267100,23267109,23267122,23267163,23267169,23267170,23267185,23267187,23267218,23267235,23267249,23267260,23267261,23267268,23267277,23266907,23267107,23267311,23267313,23267317,23267319,23267322,23267365,23267378,23267288,23267384,23267385,23267389,23267391,23267425,23266968,23267099,23267293,23267525,23267534,23267535,23267538,23267352,23267465,23267541,23267549,23267559,23267562,23267564,23267568,23267575,23267586,23267587,23267581,23267561,23267558,23267605,23267608,23267614,23267618,23267623,23267628,23267629,23267645,23266349,23266349,23267682,23267685,23267597,23267648,23267695,23267707,23267731,23267681,23267706,23267767,23267776,23267778,23267787,23267792,23267808,23267814,23267832,23267843,23267819,23267862,23267863,23267899,23267855,23267925,23267931,23267918,23267942,23267947,23267965,23267969,23267975,23267977,23267999,23268014,23267952,23267734,23267810,23267996,23268031,23268034,23267909,23267936,23268061,23268067,23268076,23268079,23268082,23268091,23268093,23268098,23268126,23268135,23267978,23268148,23268155,23268178,23268183,23268203,23268210,23268212,23268222,23268231,23268239,23268251,23268252,23268270,23268266,23268281,23268292,23268271,23268297,23268313,23268320,23268327,23268331,23268332,23268339,23268370,23268373,23268389,23268393,23268404,23268418,23268381,23268425,23268428,23268437,23268411,23268449,23268471,23268475";

    @Test
    public void testGetLaunchInfo() throws Exception {
        int dpTotalAds = 0;
        int mtTotalAds = 0;
        int totalCount = 0;
        int dpCount = 0;
        int mtCount = 0;
        for(String launchId:launchids.split(",")) {
            String url = "http://10.69.85.151:8080/search?query=term(launchid,"+ launchId +")&info=app:mtcpc&limit=0,10&fl=*";
            String result = (new com.hfb.merchant.quick.util.http.Httpz("utf-8", 30000, 30000)).get(url);
            JSONObject jsonObject = JSONObject.parseObject(result);
            if(jsonObject.getInteger("totalHits") > 0) {
                System.out.println("mt:"+launchId);
                JSONArray records = jsonObject.getJSONArray("record");
                JSONObject record = records.getJSONObject(0);
                String adpic = record.getString("adpic");
                if(StringUtils.isEmpty(adpic) || adpic.equals("{}")) {
                    mtTotalAds = mtTotalAds+jsonObject.getInteger("totalHits");
                    totalCount++;
                    mtCount++;
                }
                continue;
            }

            url = "http://10.72.183.151:8080/search?query=term(launchid,"+launchId+")&info=app:cpc&limit=0,10&fl=*";
            result = (new com.hfb.merchant.quick.util.http.Httpz("utf-8", 30000, 30000)).get(url);
            jsonObject = JSONObject.parseObject(result);
            if(jsonObject.getInteger("totalHits") > 0) {
                System.out.println("dp:"+launchId);
                JSONArray records = jsonObject.getJSONArray("record");
                JSONObject record = records.getJSONObject(0);
                String adpic = record.getString("adpic");
                if(StringUtils.isEmpty(adpic) || adpic.equals("{}")) {
                    dpTotalAds = dpTotalAds+jsonObject.getInteger("totalHits");
                    totalCount++;
                    dpCount++;
                }
                continue;
            }
        }

        System.out.println("total available launch count:"+totalCount+",dp:"+dpCount+",mt:"+mtCount);
        System.out.println("dp totalAds:"+dpTotalAds+",mt totalAds:"+mtTotalAds);
    }

    private String poiids = "110553730,110552033,110551999,110550846,110549691,110549053,110548532,110547829,110546175,110546029,110545700,110545324,110543870,110540823,110540020,110539940,110538849,110538188,110538030,110537825,110537333,110537157,110535930,110533905,110532724,110532626,110532041,110531696,110531517,110530480,110530296,110530232,110530101,110529814,110528686,110528287,110527656,110527629,110526508,110526153,110526081,110524568,110524181,110523950,110523522,110523277,110522706,110521826,110521348,110521033,110520332,110519755,110519710,110519578,110519194,110517904,110517859,110517422,110517097,110516146,110515174,110514730,110514720,110513831,110513779,110512658,110511141,110511044,110510927,110510777,110510518,110510274,110510038,110509600,110509223,110507937,110505338,110505098,110504734,110504084,110503595,110501751,110500995,110500819,110499868,110499747,110498911,110498191,110496832,110496602,110494722,110494624,110491416,110487101,110486855,110479097,110478673,110478299,110478149,110478047,110469673,110467533,110463158,110460629,110460133,110460105,110459184,110458972,110458817,110458384,110457917,110457015,110456956,110456790,110456382,110456111,110455430,110455167,110455132,110455091,110454600,110454306,110454285,110454054,110453766,110453443,110453026,110452831,110452784,110452779,110452298,110451990,110451579,110451378,110451251,110451019,110450950,110450381,110450175,110449912,110449894,110449869,110449730,110449571,110449392,110449129,110449058,110448942,110448599,110448228,110448206,110448129,110447279,110447218,110446653,110446390,110445939,110445920,110445444,110445433,110445324,110445281,110445151,110445110,110444899,110443934,110443464,110443394,110442649,110442255,110442084,110442035,110441638,110441637,110440594,110440550,110440365,110439906,110439654,110439439,110439268,110439146,110439124,110439086,110439020,110438932,110438916,110438864,110438826,110438089,110437938,110437745,110437666,110437626,110437568,110437519,110437499,110437000,110436795,110436125,110435569,110434977,110434854,110434782,110434031,110433481,110433372,110433126,110433066,110432481,110432182,110432056,110431999,110431835,110431555,110431382,110431270,110430835,110429968,110429368,110428995,110428462,110428459,110427865,110427723,110427492,110427488,110427073,110427070,110426918,110426636,110426606,110426297,110426290,110425996,110425640,110425563,110425532,110425493,110425433,110424659,110424610,110424087,110424004,110423511,110423510,110423312,110423247,110423084,110422908,110422875,110422869,110422808,110422807,110422800,110422709,110422683,110422634,110422555,110422512,110422483,110420622,110420273,110419975,110419453,110419137,110418626,110418444,110418365,110418345,110418213,110418010,110417778,110417635,110417606,110417370,110417350,110417029,110416873,110416818,110416781,110416350,110416300,110416108,110415852,110415722,110415014,110414938,110414557,110411421,110411420,110411347,110411308,110409958,110409849,110409745,110409707,110409196,110408879,110408561,110408473,110408471,110408407,110408043,110407371,110407238,110406884,110406459,110406420,110406348,110406144,110406009,110405742,110405544,110404816,110404798,110404679,110404362,110404339,110404214,110404035,110403802,110403663,110403092,110402808,110402794,110402703,110402479,110402284,110401829,110401767,110401701,110401592,110401567,110401529,110401472,110401416,110401348,110401250,110401223,110401197,110400686,110400608,110400569,110400470,110400405,110400363,110399843,110399702,110399421,110399390,110399336,110399306,110399279,110399271,110399146,110399047,110398962,110398877,110398497,110398461,110398450,110398226,110398075,110397843,110397725,110397721,110397642,110396403,110395784,110395666,110395540,110395511,110394343,110394333,110394053,110394003,110393941,110393907,110393574,110393559,110393451,110393368,110393288,110393050,110392874,110392795,110392603,110392581,110392546,110392391,110392380,110391993,110391916,110391542,110391508,110391356,110391203,110391125,110391030,110390963,110390904,110390790,110390787,110390474,110390415,110390344,110390329,110390169,110390157,110390061,110390003,110389709,110389696,110389694,110389672,110389645,110389438,110389387,110389384,110389309,110388889,110388634,110388463,110388246,110388047,110387987,110387927,110387852,110387547,110387502,110387461,110387443,110387384,110387381,110387291,110387222,110387159,110386967,110386961,110386906,110386857,110386824,110386765,110386712,110386463,110386403,110386402,110386308,110386304,110386301,110386280,110386263,110386166,110386146,110386131,110386091,110385957,110385876,110385823,110385780,110385629,110385467,110385371,110385340,110385187,110385010,110384947,110384934,110384865,110384715,110384363,110384251,110384248,110383724,110383657,110383281,110383244,110383237,110382997,110382960,110382857,110382807,110382798,110382769,110382753,110382738,110382608,110382312,110382287,110382083,110381907,110381779,110381645,110381439,110381327,110381262,110381110,110380846,110380819,110380802,110380736,110380733,110380723,110380695,110380665,110380627,110380422,110380401,110380375,110380338,110380218,110380209,110380174,110379994,110379974,110379807,110379663,110379566,110379492,110379404,110379008,110378913,110378753,110378665,110378521,110378517,110378480,110377677,110377576,110377546,110377490,110377338,110377229,110377198,110377010,110377008,110376923,110376736,110376578,110376568,110376538,110376400,110376276,110376230,110376046,110376023,110375757,110375579,110375503,110375182,110375100,110374870,110374857,110374833,110373231,110372950,110372923,110372856,110372480,110372444,110372376,110372187,110371814,110371537,110371275,110371113,110370906,110370825,110370795,110370467,110369542,110369452,110369387,110369297,110368846,110368761,110368419,110368226,110368030,110367891,110367818,110367467,110367409,110367260,110367178,110366979,110366970,110366931,110366916,110366822,110366340,110365704,110365677,110365559,110365518,110365491,110365374,110365294,110365271,110364409,110364327,110364163,110364139,110364017,110363794,110363702,110363106,110363085,110363042,110363032,110362928,110362844,110362792,110362591,110362274,110362188,110362125,110361882,110361875,110361799,110361516,110361253,110361034,110361027,110360679,110360662,110360593,110360276,110359908,110359789,110359629,110359351,110359180,110359126,110359011,110358952,110358663,110358611,110358554,110358492,110358247,110358072,110357883,110357761,110357536,110357524,110357504,110357457,110357423,110357263,110357247,110357171,110357099,110356951,110356935,110356834,110356819,110356741,110356679,110356654,110356629,110356583,110356564,110356452,110356223,110356204,110356188,110356009,110355756,110355629,110355265,110355232,110354839,110354521,110354466,110354324,110354101,110354097,110353910,110353807,110353790,110353551,110353547,110353535,110353327,110353178,110353006,110352558,110352449,110352291,110352203,110352183,110352153,110352146,110352116,110352097,110352013,110351979,110351952,110351924,110351865,110351856,110351834,110351646,110351457,110351338,110351326,110351295,110351163,110351052,110351048,110350908,110350791,110350768,110350504,110350368,110350346,110350252,110350235,110349848,110349738,110349677,110349648,110349632,110349481,110349444,110349265,110349231,110348786,110348640,110348544,110348511,110348506,110348450,110348270,110348203,110347874,110347844,110347777,110347765,110347692,110347490,110347448,110347344,110347302,110347297,110347184,110347179,110347097,110347095,110346891,110346595,110346363,110346319,110346201,110345905,110345827,110345753,110345563,110344606,110344321,110343947,110343935,110343664,110343565,110343201,110343097,110343025,110342568,110342529,110342320,110342319,110341969,110341613,110341483,110341410,110341331,110341231,110341056,110340997,110340839,110340824,110340801,110340599,110340586,110340316,110340222,110340202,110339983,110339921,110339790,110339641,110339374,110339315,110338462,110338421,110337913,110337666,110337592,110337566,110337531,110337474,110337159,110337158,110337150,110337083,110336934,110336717,110336678,110336508,110336282,110336233,110336142,110336086,110335993,110335427,110335359,110335318,110334857,110334553,110334462,110334405,110334403,110334035,110333806,110333727,110333296,110333294,110333283,110332842,110332775,110332686,110332617,110332246,110332056,110331982,110331871,110331835,110331811,110331686,110331588,110331568,110331484,110331139,110331056,110330691,110330684,110330598,110330540,110330248,110329907,110329890,110329765,110329721,110329389,110328843,110328736,110328527,110328174,110328068,110327937,110327884,110327570,110327551,110327280,110326567,110326549,110326507,110326407,110326308,110325682,110325022,110324887,110324436,110324357,110324287,110324126,110324062,110324004,110323759,110323732,110323710,110323431,110323303,110323273,110323217,110323011,110322737,110322422,110321630,110321595,110321533,110321459,110321107,110321006,110320898,110320805,110320796,110320692,110320375,110320220,110319924,110319384,110319049,110318939,110318813,110318765,110318745,110318724,110318647,110318238,110318038,110317914,110317839,110317455,110317361,110317334,110317302,110317108,110316996,110316990,110316897,110316865,110316803,110316757,110316737,110316623,110316577,110316576,110316537,110316106,110316024,110315823,110315772,110315670,110315641,110315634,110315576,110315437,110315369,110315281,110315257,110315195,110315172,110314953,110314944,110314801,110314685,110314642,110314598,110314277,110314232,110314190,110313915,110313881,110313808,110313723,110313389,110313377,110313267,110313122,110312892,110312522,110312518,110312450,110312120,110311613,110311501,110311331,110311260,110311253,110311193,110311186,110310995,110310965,110310844,110310797,110310552,110310305,110310117,110310106,110310061,110309945,110309712,110309710,110309678,110309581,110309462,110309342,110309305,110309198,110308596,110308452,110308059,110307938,110307937,110307838,110307815,110307766";

    @Test
    public void testCpcDetail() {
        String[] poiidArray = poiids.split(",");
        String resultIds = "";
        for(String id:poiidArray) {
            String url = "http://10.69.213.226:8080/cpc?id="+id+"&source=1";
            try {
                String result = (new com.hfb.merchant.quick.util.http.Httpz("utf-8", 30000, 30000)).get(url);
                JSONObject jsonObject = JSONObject.parseObject(result);
                if(StringUtils.isNotEmpty(jsonObject.getString("pictureurl"))) {
                    resultIds += id+",";
                }
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
        System.out.println(resultIds);
    }
}
